<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Truncations · MatrixAlgebraKit.jl</title><meta name="title" content="Truncations · MatrixAlgebraKit.jl"/><meta property="og:title" content="Truncations · MatrixAlgebraKit.jl"/><meta property="twitter:title" content="Truncations · MatrixAlgebraKit.jl"/><meta name="description" content="Documentation for MatrixAlgebraKit.jl."/><meta property="og:description" content="Documentation for MatrixAlgebraKit.jl."/><meta property="twitter:description" content="Documentation for MatrixAlgebraKit.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MatrixAlgebraKit.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">User Interface</span><ul><li><a class="tocitem" href="../compositions/">Compositions</a></li><li><a class="tocitem" href="../decompositions/">Decompositions</a></li><li class="is-active"><a class="tocitem" href>Truncations</a><ul class="internal"><li><a class="tocitem" href="#Using-Truncations-in-Decompositions"><span>Using Truncations in Decompositions</span></a></li><li><a class="tocitem" href="#Truncation-Strategies"><span>Truncation Strategies</span></a></li><li><a class="tocitem" href="#Truncation-Error"><span>Truncation Error</span></a></li></ul></li><li><a class="tocitem" href="../properties/">Matrix Properties</a></li><li><a class="tocitem" href="../matrix_functions/">Matrix functions</a></li></ul></li><li><a class="tocitem" href="../../dev_interface/">Developer Interface</a></li><li><a class="tocitem" href="../../library/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Interface</a></li><li class="is-active"><a href>Truncations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Truncations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/QuantumKitHub/MatrixAlgebraKit.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/QuantumKitHub/MatrixAlgebraKit.jl/blob/main/docs/src/user_interface/truncations.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Truncations"><a class="docs-heading-anchor" href="#Truncations">Truncations</a><a id="Truncations-1"></a><a class="docs-heading-anchor-permalink" href="#Truncations" title="Permalink"></a></h1><p>Truncation strategies allow you to control which eigenvalues or singular values to keep when computing partial or truncated decompositions. These strategies are used in the functions <a href="../../library/#MatrixAlgebraKit.eigh_trunc"><code>eigh_trunc</code></a>, <a href="../../library/#MatrixAlgebraKit.eig_trunc"><code>eig_trunc</code></a>, and <a href="../../library/#MatrixAlgebraKit.svd_trunc"><code>svd_trunc</code></a> to reduce the size of the decomposition while retaining the most important information.</p><h2 id="Using-Truncations-in-Decompositions"><a class="docs-heading-anchor" href="#Using-Truncations-in-Decompositions">Using Truncations in Decompositions</a><a id="Using-Truncations-in-Decompositions-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Truncations-in-Decompositions" title="Permalink"></a></h2><p>Truncation strategies can be used with truncated decomposition functions in two ways, as illustrated below. For concreteness, we use the following matrix as an example:</p><pre><code class="language-julia hljs">using MatrixAlgebraKit
using MatrixAlgebraKit: diagview

A = [2 1 0; 1 3 1; 0 1 4];
D, V = eigh_full(A);
diagview(D) ≈ [3 - √3, 3, 3 + √3]</code></pre><h3 id="1.-Using-the-trunc-keyword-with-a-NamedTuple"><a class="docs-heading-anchor" href="#1.-Using-the-trunc-keyword-with-a-NamedTuple">1. Using the <code>trunc</code> keyword with a <code>NamedTuple</code></a><a id="1.-Using-the-trunc-keyword-with-a-NamedTuple-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Using-the-trunc-keyword-with-a-NamedTuple" title="Permalink"></a></h3><p>The simplest approach is to pass a <code>NamedTuple</code> with the truncation parameters. For example, keeping only the largest 2 eigenvalues:</p><pre><code class="language-julia hljs">Dtrunc, Vtrunc, ϵ = eigh_trunc(A; trunc = (maxrank = 2,));
size(Dtrunc, 1) &lt;= 2</code></pre><p>Note however that there are no guarantees on the order of the output values:</p><pre><code class="language-julia hljs">diagview(Dtrunc) ≈ diagview(D)[[3, 2]]</code></pre><p>You can also use tolerance-based truncation or combine multiple criteria:</p><pre><code class="language-julia hljs">Dtrunc, Vtrunc, ϵ = eigh_trunc(A; trunc = (atol = 2.9,));
all(&gt;(2.9), diagview(Dtrunc))</code></pre><pre><code class="language-julia hljs">Dtrunc, Vtrunc, ϵ = eigh_trunc(A; trunc = (maxrank = 2, atol = 2.9));
size(Dtrunc, 1) &lt;= 2 &amp;&amp; all(&gt;(2.9), diagview(Dtrunc))</code></pre><p>In general, the keyword arguments that are supported can be found in the <code>TruncationStrategy</code> docstring:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixAlgebraKit.TruncationStrategy-Tuple{}-user_interface-truncations" href="#MatrixAlgebraKit.TruncationStrategy-Tuple{}-user_interface-truncations"><code>MatrixAlgebraKit.TruncationStrategy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">TruncationStrategy(; kwargs...)</code></pre><p>Select a truncation strategy based on the provided keyword arguments.</p><p><strong>Keyword arguments</strong></p><p>The following keyword arguments are all optional, and their default value (<code>nothing</code>) will be ignored. It is also allowed to combine multiple of these, in which case the kept values will consist of the intersection of the different truncated strategies.</p><ul><li><code>atol::Real</code> : Absolute tolerance for the truncation</li><li><code>rtol::Real</code> : Relative tolerance for the truncation</li><li><code>maxrank::Real</code> : Maximal rank for the truncation</li><li><code>maxerror::Real</code> : Maximal truncation error.</li><li><code>filter</code> : Custom filter to select truncated values.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/QuantumKitHub/MatrixAlgebraKit.jl/blob/016d6a0873bd88fb6833f41f0794ae99045959c6/src/interface/truncation.jl#L1-L16">source</a></section></article><h3 id="2.-Using-explicit-TruncationStrategy-objects"><a class="docs-heading-anchor" href="#2.-Using-explicit-TruncationStrategy-objects">2. Using explicit <code>TruncationStrategy</code> objects</a><a id="2.-Using-explicit-TruncationStrategy-objects-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Using-explicit-TruncationStrategy-objects" title="Permalink"></a></h3><p>For more control, you can construct <a href="../../library/#MatrixAlgebraKit.TruncationStrategy"><code>TruncationStrategy</code></a> objects directly. This is also what the previous syntax will end up calling.</p><pre><code class="language-julia hljs">Dtrunc, Vtrunc = eigh_trunc(A; trunc = truncrank(2))
size(Dtrunc, 1) &lt;= 2</code></pre><pre><code class="language-julia hljs">Dtrunc, Vtrunc, ϵ = eigh_trunc(A; trunc = truncrank(2) &amp; trunctol(; atol = 2.9))
size(Dtrunc, 1) &lt;= 2 &amp;&amp; all(&gt;(2.9), diagview(Dtrunc))</code></pre><h2 id="Truncation-Strategies"><a class="docs-heading-anchor" href="#Truncation-Strategies">Truncation Strategies</a><a id="Truncation-Strategies-1"></a><a class="docs-heading-anchor-permalink" href="#Truncation-Strategies" title="Permalink"></a></h2><p>MatrixAlgebraKit provides several built-in truncation strategies:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixAlgebraKit.notrunc-user_interface-truncations" href="#MatrixAlgebraKit.notrunc-user_interface-truncations"><code>MatrixAlgebraKit.notrunc</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">notrunc()</code></pre><p>Truncation strategy that does nothing, and keeps all the values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/QuantumKitHub/MatrixAlgebraKit.jl/blob/016d6a0873bd88fb6833f41f0794ae99045959c6/src/interface/truncation.jl#L47-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixAlgebraKit.truncrank-user_interface-truncations" href="#MatrixAlgebraKit.truncrank-user_interface-truncations"><code>MatrixAlgebraKit.truncrank</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">truncrank(howmany::Integer; by=abs, rev::Bool=true)</code></pre><p>Truncation strategy to keep the first <code>howmany</code> values when sorted according to <code>by</code> or the last <code>howmany</code> if <code>rev</code> is true.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/QuantumKitHub/MatrixAlgebraKit.jl/blob/016d6a0873bd88fb6833f41f0794ae99045959c6/src/interface/truncation.jl#L68-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixAlgebraKit.trunctol-user_interface-truncations" href="#MatrixAlgebraKit.trunctol-user_interface-truncations"><code>MatrixAlgebraKit.trunctol</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trunctol(; atol::Real=0, rtol::Real=0, p::Real=2, by=abs, keep_below::Bool=false)</code></pre><p>Truncation strategy to keep the values that satisfy <code>by(val) &gt; max(atol, rtol * norm(values, p)</code>. If <code>keep_below = true</code>, discard these values instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/QuantumKitHub/MatrixAlgebraKit.jl/blob/016d6a0873bd88fb6833f41f0794ae99045959c6/src/interface/truncation.jl#L113-L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixAlgebraKit.truncfilter-user_interface-truncations" href="#MatrixAlgebraKit.truncfilter-user_interface-truncations"><code>MatrixAlgebraKit.truncfilter</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">truncfilter(filter)</code></pre><p>Truncation strategy to keep the values for which <code>filter</code> returns true.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/QuantumKitHub/MatrixAlgebraKit.jl/blob/016d6a0873bd88fb6833f41f0794ae99045959c6/src/interface/truncation.jl#L88-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MatrixAlgebraKit.truncerror-user_interface-truncations" href="#MatrixAlgebraKit.truncerror-user_interface-truncations"><code>MatrixAlgebraKit.truncerror</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">truncerror(; atol::Real=0, rtol::Real=0, p::Real=2)</code></pre><p>Truncation strategy for truncating values such that the error in the factorization is smaller than <code>max(atol, rtol * norm)</code>, where the error is determined using the <code>p</code>-norm.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/QuantumKitHub/MatrixAlgebraKit.jl/blob/016d6a0873bd88fb6833f41f0794ae99045959c6/src/interface/truncation.jl#L138-L143">source</a></section></article><p>Truncation strategies can be combined using the <code>&amp;</code> operator to create intersection-based truncation. When strategies are combined, only the values that satisfy all conditions are kept.</p><pre><code class="language-julia hljs">combined_trunc = truncrank(10) &amp; trunctol(; atol = 1e-6);</code></pre><h2 id="Truncation-Error"><a class="docs-heading-anchor" href="#Truncation-Error">Truncation Error</a><a id="Truncation-Error-1"></a><a class="docs-heading-anchor-permalink" href="#Truncation-Error" title="Permalink"></a></h2><p>When using truncated decompositions such as <a href="../../library/#MatrixAlgebraKit.svd_trunc"><code>svd_trunc</code></a>, <a href="../../library/#MatrixAlgebraKit.eig_trunc"><code>eig_trunc</code></a>, or <a href="../../library/#MatrixAlgebraKit.eigh_trunc"><code>eigh_trunc</code></a>, an additional truncation error value is returned. This error is defined as the 2-norm of the discarded  singular values or eigenvalues, providing a measure of the approximation quality. For <code>svd_trunc</code> and <code>eigh_trunc</code>, this corresponds to the 2-norm difference between the original and the truncated matrix. For the case of <code>eig_trunc</code>, this interpretation does not hold because the norm of the non-unitary matrix of eigenvectors and its inverse also influence the approximation quality.</p><p>For example:</p><pre><code class="language-julia hljs">using LinearAlgebra: norm
U, S, Vᴴ, ϵ = svd_trunc(A; trunc=truncrank(2))
norm(A - U * S * Vᴴ) ≈ ϵ # ϵ is the 2-norm of the discarded singular values</code></pre><h3 id="Truncation-with-SVD-vs-Eigenvalue-Decompositions"><a class="docs-heading-anchor" href="#Truncation-with-SVD-vs-Eigenvalue-Decompositions">Truncation with SVD vs Eigenvalue Decompositions</a><a id="Truncation-with-SVD-vs-Eigenvalue-Decompositions-1"></a><a class="docs-heading-anchor-permalink" href="#Truncation-with-SVD-vs-Eigenvalue-Decompositions" title="Permalink"></a></h3><p>When using truncations with different decomposition types, keep in mind:</p><ul><li><p><strong><a href="../../library/#MatrixAlgebraKit.svd_trunc"><code>svd_trunc</code></a></strong>: Singular values are always real and non-negative, sorted in descending order. Truncation by value typically keeps the largest singular values. The truncation error gives the 2-norm difference between the original and the truncated matrix.</p></li><li><p><strong><a href="../../library/#MatrixAlgebraKit.eigh_trunc"><code>eigh_trunc</code></a></strong>: Eigenvalues are real but can be negative for symmetric matrices. By default, eigenvalues are treated by absolute value, e.g. <code>truncrank(k)</code> keeps the <code>k</code> eigenvalues with largest magnitude (positive or negative). The truncation error gives the 2-norm difference between the original and the truncated matrix.</p></li><li><p><strong><a href="../../library/#MatrixAlgebraKit.eig_trunc"><code>eig_trunc</code></a></strong>: For general (non-symmetric) matrices, eigenvalues can be complex. By default, eigenvalues are treated by absolute value. The truncation error gives an indication of the magnitude of discarded values, but is not directly related to the 2-norm difference between the original and the truncated matrix.</p></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../decompositions/">« Decompositions</a><a class="docs-footer-nextpage" href="../properties/">Matrix Properties »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 22 October 2025 08:49">Wednesday 22 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body><div data-docstringscollapsed="true"></div></html>
